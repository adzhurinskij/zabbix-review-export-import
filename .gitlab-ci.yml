#variables:
#  CI_DEBUG_TRACE: "true"
variables:
  GITLAB_TOKEN: $GITLAB_TOKEN
  GITLAB_FQDN: $GITLAB_FQDN
  ZBX_USER: $ZBX_USER
  ZBX_PASSWORD: $ZBX_PASSWORD

.review: &review
  image: python:3.4
  script:
    - set
    - git config --global user.email "you@example.com"
    - git config --global user.name "Zabbix Auto Backup"
    - git clone https://oauth2:$GITLAB_TOKEN@$GITLAB_FQDN/$GROUP/$PROJECT.git
    - make ZBX_URL=$ZBX_URL ZBX_USER=$ZBX_USER ZBX_PASSWORD=$ZBX_PASSWORD TARGET_DIR=./$PROJECT
  only:
    - master

devops-zabbix:
  variables:
    PROJECT: devops-zabbix-xml
    GROUP: scm
    ZBX_URL: $DEVOPS_ZBX_URL
  <<: *review

#qa-zabbix:
#  variables:
#    PROJECT: qa-zabbix-xml
#    GROUP: scm
#    ZBX_URL: $QA_ZBX_URL
#  <<: *review

